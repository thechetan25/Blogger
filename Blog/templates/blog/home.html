{% extends "layout.html" %}
{% load static %}

{% block title %}
 Home
{% endblock title %}

{% block links%}
<style>
    #hd {
        background: linear-gradient(rgba(0,0,0,0.7),rgba(0,0,0,0.7)),url("{% static 'blog/home12.jpg' %}");
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment:fixed;
        height: 80vh;
        z-index: -999 !important;
    }
</style>
<script>
  document.addEventListener("DOMContentLoaded", function() {

    let alertBox = document.getElementById("alertBox");
    
    if (alertBox) {
        setTimeout(function() {
            alertBox.style.display = "block";
        }, 1000); 

        setTimeout(function() {
            alertBox.style.display = "none";
        }, 3000); 

    } else {
        console.error("Element with id 'alertBox' not found.");
    }
});
</script>
<link rel="stylesheet" href="{%static 'blog/home.css'%}">
<script src="{% static 'blog/home.js'%}"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Acme&family=Amita&family=Comfortaa:wght@700&family=Cookie&family=Josefin+Sans&family=Marck+Script&family=Niramit&family=Quintessential&family=Secular+One&family=Shadows+Into+Light&family=Simonetta:ital,wght@0,400;0,900;1,400;1,900&family=Sofia+Sans+Condensed:ital@0;1&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=David+Libre:wght@400;500;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Big+Shoulders+Display:wght@100..900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Big+Shoulders+Display:wght@100..900&family=Puritan:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Shanti&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Work+Sans:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Madimi+One&display=swap" rel="stylesheet">
{% endblock %}


{% block content %}
<div id="hd">
<nav class="navbar navbar-expand-lg fixed-top">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">bloG<div class="mirror-text">G</div>er</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
        <i class="bi bi-arrow-down-square-fill" id="bi"></i>
      </button>
      <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
        <ul class="navbar-nav me-auto mb-2 mb-lg-0" id="ul">
          <li class="nav-item">
            <a class="nav-link" aria-current="page" href="#" id="nv">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'create-blog' %}" id="nv">Post</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{% url 'my-blogs' %}" id="nv">My Posts</a>
          </li>
        </ul>
        <div class="btn-group dropstart">
            <button id="prof" class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
              <i class="fa-solid fa-user-graduate"></i>
            </button>
            <ul class="dropdown-menu">
              <li class="dropdown-item">{{user.username}}</li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="{% url 'profile' str=user.username %}">Account</a></li>
              <li><form action="/blog/logout" method="POST">
                {% csrf_token %}
                <button type="submit" class="dropdown-item">logout</button>
            </form></li>
            </ul>
          </div>
      </div>
    </div>
  </nav>
  <div class="container-fluid" id="ed">
    <div class="row">
      <div class="col-12" id="head">
        <h2 id="text1">One Platform , Countless Stories!</h2>
        <div class="col-12" id="bar">
          <form class="d-flex" id="search-form">
            <input type="text" class="form-control" placeholder="Search blogs" id="search">
            <button type="submit" class="btn btn-outline" id="but"><i class="bi bi-search"></i></button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container-fluid py-5" id="cards">
    <div class="row">
        <div class="col-10 offset-1" id="tle">
          <h2><strong>All Posts</strong></h2>
        </div>
        <div class="col-12 px-5">
          <div class="row">
            {% for blog in blogs%}
          <div class="col-12 col-md-6 col-sm-12 col-lg-4 py-4 px-4" id="cardw">
            <div class="col">
              <a href="{% url 'blog-view' slug=blog.slug%}" id="aw">
              <div class="card h-100" id="card">
                <div class="image-wrapper">
                {% if blog.cover%}
                <img src={{blog.cover.url}} class="card-img-top" alt="..." width="500px" height="300px" id="ing">
                {% else %}
                <img src="{% static 'blog/noimg.jpg'%}" class="card-img-top" alt="..." width="500px" height="300px" id="ing">
                {% endif%}
                <div class="vbtn">
                  <div class="row">
                    
                  </div>
                </div> 
                <div class="row">
                  <h5 class="card-title">{{ blog.title }}</h5>
                </div>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col">
                    <p class="card-text" id="us"><small>Posted by </small>{{ blog.user.username }}
                      {% if blog.user.user_det.verified %}
                      <i class="bi bi-patch-check-fill"></i>
                      {% endif %}</p>
                </div>
                <div class="col-auto">
                    <p class="card-text" id="ik">
                      {% if user not in blog.likes.all %}
                      <i class="bi bi-heart" id="lk">
                      {%else%}
                      <i class="bi bi-heart-fill" id="lk1"></i>
                      {% endif %}
                      </i><span id="ct">{{ blog.likes.count }}</span></p>
                </div>
                </div>
              </div>
              <div class="card-footer">
                  <small class="text-muted">Posted on {{ blog.posted_date_display }}</small>
              </div>              
              </div>
              </a>
            </div>
          </div>
            {% endfor %}
        </div>
    </div>
  </div>
  </div>
 {% for msg in messages%}
  <div class="alert alert-success alert-dismissible fade show" role="alert" id="alertBox">
    {{msg}}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
</div>
{% endfor %}
{% endblock %}
